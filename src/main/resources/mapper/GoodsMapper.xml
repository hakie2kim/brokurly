<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.brokurly.repository.goods.GoodsDao">
    <!-- CREATE -->
    <insert id="insert">
        INSERT INTO item
            (item_id,  name ,exp, price, dc_rt, item_dc_amt, origin,
             point_fl, cpn_elg_fl, ship_type, seller_name, pkg_type, capa,
             sell_unit, adult_verif_fl, cate_code, item_qty, wish_cnt,
             bsns_no, item_spec, sell_cnt, rev_cnt)
        VALUES
            (#{itemId}, #{name}, #{exp}, #{price}, #{dcRt}, #{itemDcAmt}, #{origin},
             #{pointFl}, #{cpnElgFl}, #{shipType}, #{sellerName}, #{pkgType} , #{capa},
             #{sellUnit}, #{adultVerifFl}, #{cateCode}, #{itemQty} , #{wishCnt},
             #{bsnsNo}, #{itemSpec}, #{sellCnt}, #{revCnt} )
    </insert>

    <insert id="addCart">
        INSERT INTO cart
        (item_id, cust_id, item_cnt)
        VALUES
        (#{itemId}, #{custId}, #{itemCnt})
    </insert>

    <insert id="insertAnnouncement">
        INSERT INTO item_announcement
            (item_id, item_ann, item_ann_cate)
        VALUES (#{itemId},#{itemAnn},#{itemAnnCate})
    </insert>

    <!-- READ -->
    <sql id="select">
        SELECT * FROM item
    </sql>

    <select id="selectByItemId" resultType="Goods">
        <include refid="select"/>
        WHERE item_id = #{itemId}
    </select>

    <select id="selectByBsnsNo" resultType="Goods">
        <include refid="select"/>
        WHERE bsns_no = #{bsnsNo}
    </select>


    <select id="selectGoodsListByCateCode" resultType="Goods">
        select  item_id, name, exp, price, dc_rt, item_dc_amt, rev_cnt, ship_type
        from ITEM
        where cate_code LIKE CONCAT(#{cateCode},'%')
        limit #{limit} offset #{start}
    </select>



    <select id="sortGoodsList" resultType="Goods">
        SELECT
        item_id, name, exp, price, dc_rt, item_dc_amt, rev_cnt, ship_type
        FROM
        ITEM
        WHERE
        cate_code LIKE CONCAT(#{cateCode},'%')
        <choose>
            <when test="sortedtype == 4">
                ORDER BY price - item_dc_amt ASC
            </when>
            <when test="sortedtype == 5">
                ORDER BY price - item_dc_amt DESC
            </when>
            <when test="sortedtype == 2">
                ORDER BY sell_cnt DESC
            </when>
            <when test="sortedtype == 3">
                ORDER BY dc_rt DESC
            </when>
            <when test="sortedtype == 1">
                ORDER BY reg_dt DESC
            </when>
        </choose>
        LIMIT #{limit} OFFSET #{start}
    </select>






<!--    <select id="sortGoodsListByRegDate" resultType="Goods">-->
<!--        select  item_id, name, exp, price, dc_rt, item_dc_amt, rev_cnt, ship_type-->
<!--        from ITEM-->
<!--        where cate_code LIKE CONCAT(#{cateCode},'%')-->
<!--        order by reg_dt desc-->
<!--        limit #{limit} offset #{start}-->
<!--    </select>-->

<!--    <select id="sortGoodsListByLowPrice" resultType="Goods">-->
<!--        select  item_id, name, exp, price, dc_rt, item_dc_amt, rev_cnt, ship_type-->
<!--        from ITEM-->
<!--        where cate_code LIKE CONCAT(#{cateCode},'%')-->
<!--        order by price-item_dc_amt asc-->
<!--         limit #{limit} offset #{start}-->
<!--    </select>-->

<!--    <select id="sortGoodsListByHighPrice" resultType="Goods">-->
<!--        select  item_id, name, exp, price, dc_rt, item_dc_amt, rev_cnt, ship_type-->
<!--        from ITEM-->
<!--        where cate_code LIKE CONCAT(#{cateCode},'%')-->
<!--        order by price-item_dc_amt desc-->
<!--        limit #{limit} offset #{start}-->
<!--    </select>-->

<!--    <select id="sortGoodsListBySellCnt" resultType="Goods">-->
<!--        select  item_id, name, exp, price, dc_rt, item_dc_amt, rev_cnt, ship_type-->
<!--        from ITEM-->
<!--        where cate_code LIKE CONCAT(#{cateCode},'%')-->
<!--        order by sell_cnt desc-->
<!--        limit #{limit} offset #{start}-->
<!--    </select>-->

<!--    <select id="sortGoodsListByDcRt" resultType="Goods">-->
<!--        select  item_id, name, exp, price, dc_rt, item_dc_amt, rev_cnt, ship_type-->
<!--        from ITEM-->
<!--        where cate_code LIKE CONCAT(#{cateCode},'%')-->
<!--        order by dc_rt desc-->
<!--        limit #{limit} offset #{start}-->
<!--    </select>-->

    <select id="countGoodsListByCateCode" resultType="int">
        select count(*)
        from ITEM
        where cate_code LIKE CONCAT(#{cateCode},'%')
    </select>


    <!-- UPDATE -->
    <update id="update">
        UPDATE item
        SET name = #{name},
            exp = #{exp},
            price = #{price},
            dc_rt = #{dcRt},
            item_dc_amt = #{itemDcAmt},
            origin = #{origin},
            point_fl = #{pointFl},
            cpn_elg_fl = #{cpnElgFl},
            ship_type = #{shipType},
            seller_name = #{sellerName},
            pkg_type = #{pkgType},
            capa = #{capa},
            sell_unit = #{sellUnit},
            reg_dt = #{regDt},
            adult_verif_fl = #{adultVerifFl},
            cate_code = #{cateCode},
            item_qty = #{itemQty},
            wish_cnt = #{wishCnt},
            bsns_no = #{bsnsNo},
            item_spec = #{itemSpec},
            sell_cnt = #{sellCnt},
            rev_cnt = #{revCnt},
            stdy_seller_fl = #{stdySellerFl}
        WHERE item_id = #{itemId}
    </update>

    <!-- DELETE -->
    <delete id="deleteByItemId">
        DELETE FROM item
        WHERE item_id = #{itemId}
    </delete>

</mapper>